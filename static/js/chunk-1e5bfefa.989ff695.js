(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1e5bfefa"],{8520:function(t,e,a){},a644:function(t,e,a){"use strict";a("8520")},c9ed:function(t,e,a){"use strict";a.r(e);var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"Contract_invoice_Container"},[a("div",{staticClass:"head-btn"},[a("div",{staticClass:"Type"},[a("el-radio-group",{on:{change:t.type_change},model:{value:t.invoice_type,callback:function(e){t.invoice_type=e},expression:"invoice_type"}},[a("el-radio-button",{attrs:{label:"待上传"}}),a("el-radio-button",{attrs:{label:"已上传"}})],1)],1),["已上传"].includes(t.invoice_type)?a("div",{staticClass:"Search"}):t._e(),a("div",{staticClass:"newin_refresh"},[a("div",{staticClass:"refresh"},[a("el-button",{attrs:{icon:"el-icon-refresh"},on:{click:t.refresh}},[t._v("刷新列表 ")])],1)])]),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"multipleTable",staticClass:"tablestyle",staticStyle:{width:"100%"},attrs:{id:"outTable",data:t.tableData,"tooltip-effect":"dark",stripe:""}},[a("el-table-column",{attrs:{type:"expand",label:"详情",width:"55"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-form",{staticClass:"demo-table-expand",attrs:{"label-position":"left",inline:""}},[a("el-form-item",{attrs:{label:"项目名称"}},[a("span",[t._v(t._s(e.row.projectName))])]),a("el-form-item",{attrs:{label:"合同编号"}},[a("span",[t._v(t._s(e.row.projectCode))])]),a("el-form-item",{attrs:{label:"受让方"}},[a("span",[t._v(t._s(e.row.paName))])]),a("el-form-item",{attrs:{label:"转让总金额"}},[a("span",[t._v(t._s(e.row.totalTransferAmount)+" 万元")])]),a("el-form-item",{attrs:{label:"转化状态"}},[a("span",[t._v(t._s(e.row.state))])]),null!=e.row.publicNoticeTime?a("el-form-item",{attrs:{label:"公示信息"}},[a("span",[t._v("已经公示 "+t._s(e.row.publicNoticeTime)+" 天")])]):t._e(),a("el-form-item",{attrs:{label:"更新时间"}},[a("span",[t._v(t._s(e.row.gmtUpdate))])])],1)]}}])}),a("el-table-column",{attrs:{prop:"index",label:"序号",width:"70"}}),a("el-table-column",{attrs:{prop:"projectName",label:"合同名称"}}),a("el-table-column",{attrs:{prop:"projectCode",label:"合同编号",width:"120"}}),a("el-table-column",{attrs:{prop:"paName",label:"受让方"}}),a("el-table-column",{attrs:{prop:"state",label:"转化状态",width:"300"}}),a("el-table-column",{attrs:{prop:"setting",label:"操作",width:"400"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"settings"},[a("el-button",{attrs:{icon:"el-icon-document"},on:{click:function(a){return t.seeContract(e.row)}}},[t._v(" 查看 ")]),"待上传"==t.invoice_type?a("el-button",{attrs:{icon:"el-icon-folder-opened"},on:{click:function(a){return t.download(e.row,"Four")}}},[t._v("一键下载 ")]):t._e(),"已上传"==t.invoice_type?a("el-button",{attrs:{icon:"el-icon-folder-opened"},on:{click:function(a){return t.download(e.row,"All")}}},[t._v("一键下载 ")]):t._e(),["等待上传到款凭证","等待上传认定清单（备案）","等待生成入账通知单","等待上传发票","等待流程结束","流程已结束"].includes(e.row.state)?a("el-dropdown",{attrs:{trigger:"click"},on:{command:t.handleCommand_download}},[a("el-button",{staticClass:"dropdown_button",attrs:{icon:"el-icon-download"},on:{click:function(a){return t.download_button(e.row)}}},[t._v(" 下载文件 ")]),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[["等待上传到款凭证","等待上传认定清单（备案）","等待生成入账通知单","等待上传发票","等待流程结束","流程已结束"].includes(e.row.state)?a("el-dropdown-item",{attrs:{command:"Contract"}},[t._v("合同 ")]):t._e(),["等待上传认定清单（备案）","等待生成入账通知单","等待上传发票","等待流程结束","流程已结束"].includes(e.row.state)?a("el-dropdown-item",{attrs:{command:"Voucher"}},[t._v("到款凭证 ")]):t._e(),["等待生成入账通知单","等待上传发票","等待流程结束","流程已结束"].includes(e.row.state)?a("el-dropdown-item",{attrs:{command:"Checklist"}},[t._v("认定清单 ")]):t._e(),["等待上传发票","等待流程结束","流程已结束"].includes(e.row.state)?a("el-dropdown-item",{attrs:{command:"AccountingInfo"}},[t._v("入账通知单 ")]):t._e(),["等待流程结束","流程已结束"].includes(e.row.state)?a("el-dropdown-item",{attrs:{command:"Invoice"}},[t._v("发票 ")]):t._e()],1)],1):t._e(),["等待上传合同","等待上传到款凭证","等待上传认定清单（备案）","等待生成入账通知单","等待上传发票","等待流程结束"].includes(e.row.state)?a("el-button",{staticClass:"dropdown_button",attrs:{slot:"reference",icon:"el-icon-upload2"},on:{click:function(a){return t.upload_file(e.row)}},slot:"reference"},[t._v("上传文件 ")]):t._e()],1)]}}])})],1),a("div",{staticClass:"PagesCurb"},[a("el-pagination",{staticClass:"pages",attrs:{currentPage:t.currentPage,"page-size":10,layout:"total, prev, pager, next",total:t.total},on:{"current-change":t.handleCurrentPage}})],1),a("el-dialog",{attrs:{title:"选择上传文件类型",visible:t.file_type_Dialog,width:"30%"},on:{"update:visible":function(e){t.file_type_Dialog=e}}},[a("div",{staticClass:"uploads"},[a("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{action:"/pdf/upload","show-file-list":!1,"http-request":t.Upload}},[a("el-button",{attrs:{icon:"el-icon-tickets"},on:{click:function(e){return t.upload(t.upload_row,"Invoice")}}},[t._v("发票 ")])],1)],1)])],1)},n=[],r=a("1da1"),c=(a("ac1f"),a("1276"),a("fb6a"),a("b0c0"),a("d3b7"),a("3ca3"),a("ddb0"),a("2b3d"),a("96cf"),{data:function(){return{tableData:[],loading:!0,invoice_type:"待上传",total:0,currentPage:1,Page_url:"",download_row:{},file_type_Dialog:!1,upload_row:{},upload_content:{type:"",contractInfoId:""}}},created:function(){this.refresh()},methods:{refresh:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){var a,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=t,a.tableData=[],a.currentPage=1,console.log(t.$store.state),o="/cwc/getContractListInvoiceIsNull?currPage="+a.currentPage+"&size=20",a.Page_url=o,e.next=8,a.getContract(o);case 8:case"end":return e.stop()}}),e)})))()},getContract:function(t){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function a(){var o;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return o=e,o.tableData=[],a.next=4,o.request(t,{},"GET",{}).then((function(t){if(console.log(t.data),o.loading=!1,"success"==t.data.status){o.total=t.data.data.total;for(var a=0;a<t.data.data.records.length;a++){var n={};n.index=a+1,n.arbitrationCommission=t.data.data.records[a].arbitrationCommission,n.contractInfoId=t.data.data.records[a].contractInfoId,n.contractSigningDate=t.data.data.records[a].contractSigningDate,n.disputeSettlementMethod=t.data.data.records[a].disputeSettlementMethod,n.gmtUpdate=t.data.data.records[a].gmtUpdate,n.invoicingEnterprise=t.data.data.records[a].invoicingEnterprise,n.paAddress=t.data.data.records[a].paAddress,n.paContactEmail=t.data.data.records[a].paContactEmail,n.paContactPerson=t.data.data.records[a].paContactPerson,n.paContactPhone=t.data.data.records[a].paContactPhone,n.paMailingAddress=t.data.data.records[a].paMailingAddress,n.paName=t.data.data.records[a].paName,n.paRepresentative=t.data.data.records[a].paRepresentative,n.patentNum=t.data.data.records[a].patentNum,n.paymentMethod=t.data.data.records[a].paymentMethod,n.pbContactPerson=t.data.data.records[a].pbContactPerson,n.pbImplPatentRight=t.data.data.records[a].pbImplPatentRight,n.pbLicensedPatentRight=t.data.data.records[a].pbLicensedPatentRight,n.projectCode=t.data.data.records[a].projectCode,n.projectName=t.data.data.records[a].projectName,n.publicNoticeTime=t.data.data.records[a].isPublicNotice?n.publicNoticeTime=o.TimeDiffer(t.data.data.records[a].publicNoticeTime):null,n.taxpayerCode=t.data.data.records[a].taxpayerCode,n.totalTransferAmount=t.data.data.records[a].totalTransferAmount,t.data.data.records[a].isPublicNotice?null==t.data.data.records[a].contractFileId?n.state="等待上传合同":null==t.data.data.records[a].voucherId?n.state="等待上传到款凭证":null==t.data.data.records[a].checklistId?n.state="等待上传认定清单（备案）":null==t.data.data.records[a].accountingInfoId?n.state="等待生成入账通知单":null==t.data.data.records[a].invoiceId?n.state="等待上传发票":t.data.data.records[a].isComplete?n.state="流程已结束":n.state="等待流程结束":n.state="等待公示",o.tableData.push(n)}e.$message({message:"数据已更新！",type:"success"})}else e.$message({message:t.data.data.errMsg,type:"error"})})).catch((function(t){console.log(t),o.loading=!1,e.$message({message:"出错了！",type:"error"})}));case 4:case"end":return a.stop()}}),a)})))()},handleCurrentPage:function(t){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function a(){var o,n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return o=e,o.loading=!0,console.log(o.Page_url),n=o.Page_url.split("currPage")[0]+"currPage="+t+"&size"+o.Page_url.split("size")[1],console.log(n),o.tableData=[],o.currentPage=t,a.next=9,o.getContract(n);case 9:case"end":return a.stop()}}),a)})))()},type_change:function(t){console.log(t);var e=this;e.loading=!0,e.tableData=[];var a="";switch(t){case"待上传":a="/cwc/getContractListInvoiceIsNull?currPage="+e.currentPage+"&size=20";break;case"已上传":a="/cwc/getContractListInvoiceIsNotNull?currPage="+e.currentPage+"&size=20";break;default:break}e.Page_url=a,e.getContract(a)},TimeTransfer:function(t){var e=new Date(t),a=e.getFullYear(),o=e.getMonth()+1,n=e.getDate(),r=e.getHours(),c=e.getMinutes(),s=e.getSeconds(),l=a+"-";return o<10&&(l+="0"),l+=o+"-",n<10&&(l+="0"),l+=n+" ",r<10&&(l+="0"),l+=r+":",c<10&&(l+="0"),l+=c+":",s<10&&(l+="0"),l+=s,l},TimeDiffer:function(t){var e=this.TimeTransfer(t),a=new Date,o=new Date(e),n=(a-o)/1e3,r=parseInt(n/86400);parseInt(n/3600),parseInt(n%3600/60),parseInt(n%60);return r},handleDropdown:function(t){var e=this;e.SearchType=t},seeContract:function(t){console.log(t),this.$router.push({path:"/contract_detail",query:{contractInfoId:t.contractInfoId}})},upload:function(t,e){this.upload_content.type=e,this.upload_content.contractInfoId=t.contractInfoId,console.log(this.upload_content)},Upload:function(t){var e=this,a=this;console.log(t);var o="";switch(a.upload_content.type){case"Contract":o="/transferring/uploadContract";break;case"Voucher":o="/transferring/uploadVoucher";break;case"Checklist":o="/transferring/uploadChecklist";break;case"Invoice":o="/transferring/uploadInvoice";break;default:break}if("pdf"!=t.file.name.split(".").slice(-1))this.$message.warning("上传文件只能是pdf格式!");else{var n=new FormData;n.append("file",t.file),n.append("contractInfoId",a.upload_content.contractInfoId),console.log(n),a.request(o,n,"POST",{}).then((function(t){console.log(t),"success"==t.data.status?(e.$message({type:"success",message:"上传成功！"}),a.file_type_Dialog=!1,a.refresh()):e.$message({message:t.data.data.errMsg,type:"error"})})).catch((function(t){console.log(t),e.$message({message:"出错了！",type:"error"})}))}},download:function(t,e){var a=this,o=this,n="",r="";switch(console.log(t),e){case"Contract":n="/transferring/downloadContract?contractInfoId="+t.contractInfoId,r="合同.pdf";break;case"Voucher":n="/transferring/downloadVoucher?contractInfoId="+t.contractInfoId,r="到款凭证.pdf";break;case"Checklist":n="/transferring/downloadChecklist?contractInfoId="+t.contractInfoId,r="备案清单.pdf";break;case"AccountingInfo":n="/transferring/downloadAccounting?contractInfoId="+t.contractInfoId,r="入账通知单.doc";break;case"Invoice":n="/transferring/downloadInvoice?contractInfoId="+t.contractInfoId,r="发票.pdf";break;case"Four":n="/transferring/downloadPackage?contractInfoId="+t.contractInfoId,r="文件（无发票）.7z";break;case"All":n="/transferring/downloadPackageAll?contractInfoId="+t.contractInfoId,r="全部文件.7z";break;default:break}o.request(n,{},"GET",{},"blob").then((function(t){console.log(t);try{var e=new Blob([t.data],{type:"application/force-download"}),o=URL.createObjectURL(e),n=document.createElement("a");n.href=o,n.setAttribute("download",r),document.body.appendChild(n),n.click(),document.body.removeChild(n)}catch(c){console.log(c),a.$message({message:"数据请求失败！",type:"error"})}})).catch((function(t){console.log(t),a.$message({message:"出错了！",type:"error"})}))},upload_file:function(t){console.log(t),this.upload_row=t,this.file_type_Dialog=!0},download_button:function(t){console.log(t),this.download_row=t},handleCommand_download:function(t){console.log(t),this.download(this.download_row,t)},handleCommand_upload:function(t){console.log(t)}}}),s=c,l=(a("a644"),a("2877")),d=Object(l["a"])(s,o,n,!1,null,null,null);e["default"]=d.exports}}]);