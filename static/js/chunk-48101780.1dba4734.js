(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-48101780"],{"2a79":function(e,t,a){e.exports=a.p+"static/img/file_pdf.1bf2177c.png"},3667:function(e,t,a){},"4d96":function(e,t,a){"use strict";a("3667")},"57da":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"Files_Patents_Detail_Container"},[i("div",{staticClass:"top_buttons"},[e.multipleSelection.length>0?i("el-button",{staticStyle:{"margin-right":"10px"},attrs:{icon:"el-icon-download"},on:{click:e.List_download}},[e._v(" 打包下载 ")]):e._e(),"现金奖励"==e.drawMoneyMethod?i("el-button",{staticStyle:{"margin-right":"10px"},attrs:{icon:"el-icon-document"},on:{click:e.get_tax}},[e._v(" 生成个人所得税备案表 ")]):e._e(),i("el-upload",{attrs:{action:"/pdf/upload","show-file-list":!1,"http-request":e.Upload}},["finance"!=e.authorize?i("el-button",{attrs:{type:"text",icon:"el-icon-upload2"}},[e._v("上传专利证书")]):e._e()],1)],1),i("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.tableData,"tooltip-effect":"dark"},on:{"selection-change":e.handleSelectionChange}},[i("el-table-column",{attrs:{type:"selection",width:"55"}}),i("el-table-column",{attrs:{prop:"file_name",label:"文件名"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("div",{staticClass:"filebox"},[i("img",{attrs:{src:a("2a79")}}),i("a",{on:{click:function(a){return e.pdf_preview(t.row)}}},[e._v(e._s(t.row.file_name))])])]}}])}),i("el-table-column",{attrs:{prop:"fixtime",label:"更新时间"}}),i("el-table-column",{attrs:{prop:"setting",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("div",{staticClass:"setting"},[i("el-button",{attrs:{icon:"el-icon-download",type:"text"},on:{click:function(a){return e.downloadFiles(t.row)}}},[e._v(" 下载 ")])],1)]}}])})],1)],1)},o=[],s=a("5530"),n=(a("caad"),a("ac1f"),a("1276"),a("b0c0"),a("2f62")),l=a("af2c"),r={data:function(){return{tableData:[],loading:!0,multipleSelection:[],drawMoneyMethod:this.$store.state.contract_files.patentList[this.$route.query.index].drawMoneyMethod,wid:this.$store.state.contract_files.patentList[this.$route.query.index].wid,projectCode:this.$store.state.contract_files.projectCode,contractInfoId:this.$store.state.contract_files.contractInfoId,authorize:this.$store.state.signed_authorize}},created:function(){if(console.log(this.$route.query),null!=this.$store.state.contract_files.patentList[this.$route.query.index].certificate){var e={};e.file_name=this.$store.state.contract_files.patentList[this.$route.query.index].certificate.fileDisplayName,e.fixtime=this.$store.state.contract_files.patentList[this.$route.query.index].certificate.gmtCreate,e.fileId=this.$store.state.contract_files.patentList[this.$route.query.index].certificate.fileId,this.tableData.push(e)}if(null!=this.$store.state.contract_files.patentList[this.$route.query.index].oa){var t={};t.file_name=this.$store.state.contract_files.patentList[this.$route.query.index].oa.fileDisplayName,t.fixtime=this.$store.state.contract_files.patentList[this.$route.query.index].oa.gmtCreate,t.fileId=this.$store.state.contract_files.patentList[this.$route.query.index].oa.fileId,this.tableData.push(t)}if(null!=this.$store.state.contract_files.patentList[this.$route.query.index].tax){var a={};a.file_name=this.$store.state.contract_files.patentList[this.$route.query.index].tax.fileDisplayName,a.fixtime=this.$store.state.contract_files.patentList[this.$route.query.index].tax.gmtCreate,a.fileId=this.$store.state.contract_files.patentList[this.$route.query.index].tax.fileId,this.tableData.push(a)}},methods:Object(s["a"])(Object(s["a"])({},Object(n["c"])(["get_files"])),{},{handleSelectionChange:function(e){this.multipleSelection=e},Upload:function(e){var t=this,a=this;if(console.log(e),["pdf","png","jpg","jpeg"].includes(e.file.name.split(".")[1]))if(e.file.size/1024/1024>10)this.$message.warning("上传文件大小不得超过10M!");else{var i=new FormData;i.append("file",e.file),i.append("wid",a.wid),console.log(i),a.request("/file/uploadCertificate",i,"POST",{}).then((function(e){if(console.log(e),"success"==e.data.status){t.$notify.success({title:"成功",message:"上传成功！"});var i="/file/getFileListByContractInfoId?contractInfoId="+a.contractInfoId;a.request(i,{},"GET",{}).then((function(e){console.log(e.data),"success"==e.data.status?(t.get_files(e.data.data),sessionStorage.setItem("state",JSON.stringify(t.$store.state)),window.location.reload()):a.$message.error(e.data.data.errMsg)})).catch((function(e){console.log(e),a.$message.error("出错了！")}))}else t.$message({message:e.data.data.errMsg,type:"error"})})).catch((function(e){console.log(e),t.$message({message:"出错了！",type:"error"})}))}else this.$message.warning("上传文件只能是pdf或图片!")},downloadFiles:function(e){var t="/file/downloadFileById?fileId="+e.fileId;l["a"].downloadFiles(t)},get_tax:function(){var e=this,t=this,a="/file/generateTaxFilingForm?transferApplicationFormId="+this.$store.state.contract_files.patentList[this.$route.query.index].transferApplicationFormId;t.request(a,{},"GET",{}).then((function(a){if("success"==a.data.status){e.$notify.success({title:"成功",message:"已生成！"});var i="/file/getFileListByContractInfoId?contractInfoId="+t.contractInfoId;t.request(i,{},"GET",{}).then((function(a){console.log(a.data),"success"==a.data.status?(e.get_files(a.data.data),sessionStorage.setItem("state",JSON.stringify(e.$store.state)),window.location.reload()):t.$message.error(a.data.data.errMsg)})).catch((function(e){console.log(e),t.$message.error("出错了！")}))}else e.$message({message:a.data.data.errMsg,type:"error"})})).catch((function(a){console.log(a),t.loading=!1,e.$message({message:"出错了！",type:"error"})}))},List_download:function(){var e=[];console.log(this.multipleSelection);for(var t=0;t<this.multipleSelection.length;t++)e.push(this.multipleSelection[t].fileId);l["a"].downloadFilePackage(this.projectCode,e)},pdf_preview:function(e){console.log(e),l["a"].previewFile(e.fileId)}})},c=r,d=(a("4d96"),a("2877")),f=Object(d["a"])(c,i,o,!1,null,null,null);t["default"]=f.exports},af2c:function(e,t,a){"use strict";a("ac1f"),a("1276"),a("caad"),a("d3b7"),a("3ca3"),a("ddb0"),a("2b3d");var i=a("4ec3"),o=a("5c96"),s=a.n(o),n=function(e){var t="/file/downloadFileById?fileId="+e;Object(i["a"])(t,{},"GET",{},"arraybuffer").then((function(e){if(console.log(e),void 0==e.headers["content-disposition"])s.a.Notification({title:"错误",message:"文件可能丢失了！",type:"error"});else{var t="",a=e.headers["content-disposition"].split("fileName=")[1].split(".").length,i=e.headers["content-disposition"].split("fileName=")[1].split(".")[a-1];if(["pdf","png","jpg","jpeg"].includes(i)){switch(i){case"pdf":t="application/pdf";break;case"png":t="image/png";break;case"jpg":t="image/jpeg";break;case"jpeg":t="image/jpeg";break}var o=e.data,n=decodeURI(e.headers["content-disposition"].split("fileName=")[1]);if(window.navigator&&window.navigator.msSaveOrOpenBlob){var l=new Blob([o],{type:t});console.log(n),window.navigator.msSaveOrOpenBlob(l,n)}else{var r=new Blob([o],{type:t}),c=window.URL.createObjectURL(r);console.log(c),window.open(c)}}else s.a.Notification({title:"提示",message:"该文件类型暂不支持在线预览，请下载后查看！",type:"warning"})}})).catch((function(e){console.log(e),s.a.Message({message:"出错了！",type:"error"})}))},l=function(e){Object(i["a"])(e,{},"GET",{},"blob").then((function(t){if(console.log(t),void 0!=t.headers["content-disposition"]){s.a.Notification({title:"成功",message:"准备开始下载！",type:"success"});var a=decodeURI(t.headers["content-disposition"].split("fileName=")[1]);try{var o=new Blob([t.data],{type:"application/force-download"}),n=URL.createObjectURL(o),l=document.createElement("a");l.href=n,l.setAttribute("download",a),document.body.appendChild(l),l.click(),document.body.removeChild(l)}catch(r){console.log(r),s.a.Message({message:"数据请求失败！",type:"error"})}}else Object(i["a"])(e,{},"GET",{}).then((function(e){s.a.Message({message:e.data.data.errMsg,type:"error"})}))})).catch((function(e){console.log(e),s.a.Message({message:"出错了！",type:"error"})}))},r=function(e,t){var a="";if(0==t.length)s.a.Notification.warning({title:"提示",message:"文件为空！"});else{if(1==t.length)a="/file/downloadPackage?projectCode="+e+"&fileIdList="+t[0];else if(t.length>1){a="/file/downloadPackage?projectCode="+e+"&fileIdList="+t[0];for(var o=1;o<t.length;o++)a=a+"&fileIdList="+t[o]}Object(i["a"])(a,{},"GET",{},"blob").then((function(e){if(void 0!=e.headers["content-disposition"]){s.a.Notification({title:"成功",message:"准备开始下载！",type:"success"});var t=decodeURI(e.headers["content-disposition"].split("fileName=")[1]);try{var a=new Blob([e.data],{type:"application/force-download"}),i=URL.createObjectURL(a),o=document.createElement("a");o.href=i,o.setAttribute("download",t),document.body.appendChild(o),o.click(),document.body.removeChild(o)}catch(n){console.log(n),s.a.Message({message:"数据请求失败！",type:"error"})}}else s.a.Message({message:"文件可能丢失了！",type:"error"})})).catch((function(e){console.log(e),s.a.Message({message:"出错了！",type:"error"})}))}};t["a"]={previewFile:n,downloadFiles:l,downloadFilePackage:r}}}]);