(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-b6532af4"],{"0473":function(t,e,a){"use strict";a("1d6e")},"1d6e":function(t,e,a){},"79ce":function(t,e,a){"use strict";a.r(e);var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"contract_Container"},[a("div",{staticClass:"head-btn"},[a("div",{staticClass:"Type"},[a("el-radio-group",{model:{value:t.contract_type,callback:function(e){t.contract_type=e},expression:"contract_type"}},[a("el-radio-button",{attrs:{label:"进行中"}})],1)],1),a("div",{staticClass:"newin_refresh"},[a("div",{staticClass:"refresh"},[a("el-button",{attrs:{icon:"el-icon-document"},on:{click:t.savedContracts}},[t._v(" 草稿箱 ")]),a("el-button",{attrs:{icon:"el-icon-delete"},on:{click:t.deletedContracts}},[t._v(" 垃圾箱 ")])],1)])]),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"multipleTable",staticClass:"tablestyle",staticStyle:{width:"100%"},attrs:{id:"outTable",data:t.tableData,"tooltip-effect":"dark",stripe:""}},[a("el-table-column",{attrs:{type:"expand",label:"详情",width:"55"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-form",{staticClass:"demo-table-expand",attrs:{"label-position":"left",inline:""}},[a("el-form-item",{attrs:{label:"合同名称"}},[a("span",[t._v(t._s(e.row.projectName))])]),a("el-form-item",{attrs:{label:"合同编号"}},[a("span",[t._v(t._s(e.row.projectCode))])]),a("el-form-item",{attrs:{label:"合同类别"}},[a("span",[t._v(t._s(e.row.contractType))])]),a("el-form-item",{attrs:{label:"受让方"}},[a("span",[t._v(t._s(e.row.paName))])]),a("el-form-item",{attrs:{label:"转让总金额"}},[a("span",[t._v(t._s(e.row.totalTransferAmount)+" 万元")])]),a("el-form-item",{attrs:{label:"转化状态"}},[a("span",[t._v(t._s(e.row.state))])]),null!=e.row.publicNoticeTime?a("el-form-item",{attrs:{label:"公示信息"}},[a("span",[t._v("已经公示 "+t._s(e.row.publicNoticeTime)+" 天")])]):t._e(),a("el-form-item",{attrs:{label:"更新时间"}},[a("span",[t._v(t._s(e.row.gmtUpdate))])])],1)]}}])}),a("el-table-column",{attrs:{prop:"index",label:"序号",width:"70"}}),a("el-table-column",{attrs:{prop:"projectName",label:"合同名称"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("a",{on:{click:function(a){return t.seeContract(e.row)}}},[t._v(t._s(e.row.projectName))])]}}])}),a("el-table-column",{attrs:{prop:"projectCode",label:"合同编号",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("a",{on:{click:function(a){return t.seeContract(e.row)}}},[t._v(t._s(e.row.projectCode))])]}}])}),a("el-table-column",{attrs:{prop:"paName",label:"受让方单位"}}),a("el-table-column",{attrs:{prop:"state",label:"转化状态",width:"160"}}),a("el-table-column",{attrs:{prop:"setting",label:"操作",width:"300"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"settings"},[["等待上传合同"].includes(e.row.state)?a("el-button",{attrs:{icon:"el-icon-reading"},on:{click:t.getPublicNotice_detail}},[t._v(" 公示页 ")]):t._e(),["等待上传合同"].includes(e.row.state)?a("el-button",{attrs:{icon:"el-icon-printer"},on:{click:function(a){return t.generateContract(e.row)}}},[t._v(" 生成 ")]):t._e(),"等待上传合同"==e.row.state?a("el-button",{attrs:{icon:"el-icon-edit-outline"},on:{click:function(a){return t.editContract(e.row)}}},[t._v(" 修改 ")]):t._e(),"等待上传合同"==e.row.state?a("el-button",{attrs:{icon:"el-icon-delete"},on:{click:function(a){return t.deleteContract(e.row)}}},[t._v(" 删除 ")]):t._e(),"等待公示"==e.row.state?a("el-button",{attrs:{icon:"el-icon-reading"},on:{click:function(a){return t.BeginPublic(e.row)}}},[t._v("开始公示 ")]):t._e(),"等待流程结束"==e.row.state?a("el-button",{attrs:{icon:"el-icon-circle-check"},on:{click:function(a){return t.ConfirmEnd(e.row)}}},[t._v("确认流程结束 ")]):t._e(),["等待上传合同","等待上传到款凭证","等待上传认定清单（备案）","等待生成入账通知单","等待财务处上传发票","等待流程结束"].includes(e.row.state)?a("el-button",{attrs:{icon:"el-icon-folder-opened"},on:{click:function(a){return t.file_manage(e.row)}}},[t._v("文件管理 ")]):t._e(),a("el-button",{attrs:{slot:"reference",icon:"el-icon-edit-outline"},on:{click:function(a){return t.edit_contractCode(e.row)}},slot:"reference"},[t._v("修改合同编号 ")])],1)]}}])})],1),a("div",{staticClass:"PagesCurb"},[a("el-pagination",{staticClass:"pages",attrs:{currentPage:t.currentPage,"page-size":20,layout:"total, prev, pager, next",total:t.total},on:{"current-change":t.handleCurrentPage}})],1),a("el-dialog",{attrs:{title:"修改合同编号",visible:t.edit_contractCode_dialogFormVisible,width:"30%"},on:{"update:visible":function(e){t.edit_contractCode_dialogFormVisible=e}}},[a("el-form",{ref:"edit_contractCodeForm",attrs:{model:t.edit_contractCode_form,rules:t.edit_contractCode_rules}},[a("el-form-item",{attrs:{label:"合同编号",prop:"projectCode"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:t.edit_contractCode_form.projectCode,callback:function(e){t.$set(t.edit_contractCode_form,"projectCode",e)},expression:"edit_contractCode_form.projectCode"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.edit_contractCode_dialogFormVisible=!1}}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:t.confirm_projectCode}},[t._v("确 定")])],1)],1)],1)},n=[],r=a("1da1"),c=a("5530"),s=(a("ac1f"),a("1276"),a("caad"),a("96cf"),a("2f62")),i=a("af2c"),l={data:function(){return{tableData:[],loading:!0,contract_type:"进行中",edit_contractCode_dialogFormVisible:!1,edit_contractCode_form:{contractInfoId:"",projectCode:""},edit_contractCode_rules:{projectCode:[{required:!0,message:"请填写合同编号",trigger:"blur"}]},total:0,currentPage:1,Page_url:"",file_list:{accounting:{fileDisplayName:"",fileId:"",fileName:"",fileType:"",gmtCreate:""},checklist:{fileDisplayName:"",fileId:"",fileName:"",fileType:"",gmtCreate:""},contract:{fileDisplayName:"",fileId:"",fileName:"",fileType:"",gmtCreate:""},invoice:{fileDisplayName:"",fileId:"",fileName:"",fileType:"",gmtCreate:""},patentList:[],voucherList:[]}}},created:function(){this.refresh()},methods:Object(c["a"])(Object(c["a"])({},Object(s["c"])(["get_files"])),{},{refresh:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){var a,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=t,a.tableData=[],a.currentPage=1,a.SearchType="",a.SearchType_prepend="查询字段",a.SearchText="",a.contract_type="进行中",console.log(t.$store.state),o="/contract/getTransferringContractPage?currPage="+a.currentPage+"&size=20",a.Page_url=o,e.next=12,a.getContract(o);case 12:case"end":return e.stop()}}),e)})))()},getContract:function(t){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function a(){var o;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return o=e,o.tableData=[],a.next=4,o.request(t,{},"GET",{}).then((function(t){if(console.log(t.data),o.loading=!1,"success"==t.data.status){o.total=t.data.data.total;for(var a=0;a<t.data.data.records.length;a++){var n={};n.index=a+1,n.arbitrationCommission=t.data.data.records[a].arbitrationCommission,n.contractInfoId=t.data.data.records[a].contractInfoId,n.contractSigningDate=t.data.data.records[a].contractSigningDate,n.contractType=t.data.data.records[a].contractType,n.disputeSettlementMethod=t.data.data.records[a].disputeSettlementMethod,n.gmtUpdate=t.data.data.records[a].gmtUpdate,n.invoicingEnterprise=t.data.data.records[a].invoicingEnterprise,n.paAddress=t.data.data.records[a].paAddress,n.paContactEmail=t.data.data.records[a].paContactEmail,n.paContactPerson=t.data.data.records[a].paContactPerson,n.paContactPhone=t.data.data.records[a].paContactPhone,n.paMailingAddress=t.data.data.records[a].paMailingAddress,n.paName=t.data.data.records[a].paName,n.paRepresentative=t.data.data.records[a].paRepresentative,n.patentNum=t.data.data.records[a].patentNum,n.paymentMethod=t.data.data.records[a].paymentMethod,n.pbContactPerson=t.data.data.records[a].pbContactPerson,n.pbImplPatentRight=t.data.data.records[a].pbImplPatentRight,n.pbLicensedPatentRight=t.data.data.records[a].pbLicensedPatentRight,n.projectCode=t.data.data.records[a].projectCode,n.projectName=t.data.data.records[a].projectName,n.publicNoticeTime=t.data.data.records[a].isPublicNotice?n.publicNoticeTime=o.TimeDiffer(t.data.data.records[a].publicNoticeTime):null,n.taxpayerCode=t.data.data.records[a].taxpayerCode,n.totalTransferAmount=t.data.data.records[a].totalTransferAmount,t.data.data.records[a].isPublicNotice?null==t.data.data.records[a].contractFileId?n.state="等待上传合同":null==t.data.data.records[a].voucherId?n.state="等待上传到款凭证":null==t.data.data.records[a].checklistId?n.state="等待上传认定清单（备案）":null==t.data.data.records[a].accountingInfoId?n.state="等待生成入账通知单":null==t.data.data.records[a].invoiceId?n.state="等待财务处上传发票":t.data.data.records[a].isComplete?n.state="流程已结束":n.state="等待流程结束":n.state="等待公示",o.tableData.push(n)}e.$message({message:"数据已更新！",type:"success"})}else e.$message({message:t.data.data.errMsg,type:"error"})})).catch((function(t){console.log(t),o.loading=!1,e.$message({message:"出错了！",type:"error"})}));case 4:case"end":return a.stop()}}),a)})))()},handleCurrentPage:function(t){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function a(){var o,n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return o=e,o.loading=!0,console.log(o.Page_url),n=o.Page_url.split("currPage")[0]+"currPage="+t+"&size"+o.Page_url.split("size")[1],console.log(n),o.tableData=[],o.currentPage=t,a.next=9,o.getContract(n);case 9:case"end":return a.stop()}}),a)})))()},savedContracts:function(){this.$router.push("/save_contract")},deletedContracts:function(){this.$router.push("/delete_contract")},TimeTransfer:function(t){var e=new Date(t),a=e.getFullYear(),o=e.getMonth()+1,n=e.getDate(),r=e.getHours(),c=e.getMinutes(),s=e.getSeconds(),i=a+"-";return o<10&&(i+="0"),i+=o+"-",n<10&&(i+="0"),i+=n+" ",r<10&&(i+="0"),i+=r+":",c<10&&(i+="0"),i+=c+":",s<10&&(i+="0"),i+=s,i},TimeDiffer:function(t){var e=this.TimeTransfer(t),a=new Date,o=new Date(e),n=(a-o)/1e3,r=parseInt(n/86400);parseInt(n/3600),parseInt(n%3600/60),parseInt(n%60);return r},seeContract:function(t){console.log(t),"专利权转让"==t.contractType?this.$router.push({path:"/transfer_contract_detail",query:{contractInfoId:t.contractInfoId}}):this.$router.push({path:"/licence_contract_detail",query:{contractInfoId:t.contractInfoId}})},getPublicNotice_detail:function(){window.open("http://cxy.njupt.edu.cn/_s366/gs/list.psp")},generateContract:function(t){console.log(t);var e="/contract/generateContract?contractInfoId="+t.contractInfoId;i["a"].downloadFiles(e)},editContract:function(t){console.log(t),["专利权转让"].includes(t.contractType)?this.$router.push({path:"/filling_contract_transfer",query:{contractInfoId:t.contractInfoId,type:"edit"}}):this.$router.push({path:"/filling_contract_license",query:{contractInfoId:t.contractInfoId,type:"edit"}})},deleteContract:function(t){var e=this,a=this;console.log(t),this.$confirm("确认要删除吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var o="/contract/logicDeleteContract?contractInfoId="+t.contractInfoId;a.request(o,{},"GET",{}).then((function(t){console.log(t.data),"success"==t.data.status?(e.$notify.success({title:"成功",message:"已移至垃圾箱！"}),window.location.reload()):e.$notify.error({title:"错误",message:t.data.data.errMsg})})).catch((function(t){console.log(t),e.$notify.error({title:"错误",message:"出错了！"})}))})).catch((function(){e.$message({type:"info",message:"已取消操作！"})}))},BeginPublic:function(t){var e=this,a=this;console.log(t),a.loading=!0,this.$confirm("确认已经开始公示了吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var o="/transferring/makePublicNotice?contractInfoId="+t.contractInfoId;a.request(o,{},"GET",{}).then((function(t){console.log(t.data),a.loading=!1,"success"==t.data.status?(e.$message({type:"success",message:"开始公示！"}),window.location.reload()):e.$message({message:t.data.data.errMsg,type:"error"})})).catch((function(t){console.log(t),e.$message({message:"出错了！",type:"error"})}))})).catch((function(){e.$message({type:"info",message:"已取消操作！"})}))},file_manage:function(t){var e=this,a=this;console.log(t);var o="/file/getFileListByContractInfoId?contractInfoId="+t.contractInfoId;a.request(o,{},"GET",{}).then((function(t){console.log(t.data),"success"==t.data.status?(e.get_files(t.data.data),sessionStorage.setItem("state",JSON.stringify(e.$store.state)),e.$router.push({path:"./files_controller"})):a.$message.error(t.data.data.errMsg)})).catch((function(t){console.log(t),a.$message.error("出错了！")}))},edit_contractCode:function(t){console.log(t),this.edit_contractCode_form.contractInfoId=t.contractInfoId,this.edit_contractCode_form.projectCode=t.projectCode,this.edit_contractCode_dialogFormVisible=!0},confirm_projectCode:function(){var t=this,e=this;this.$confirm("确认要修改吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var a="/contract/updateProjectCode?contractInfoId="+t.edit_contractCode_form.contractInfoId+"&projectCode="+t.edit_contractCode_form.projectCode;e.request(a,{},"GET",{}).then((function(a){console.log(a.data),"success"==a.data.status?(t.$notify.success({title:"成功",message:"修改成功！"}),e.edit_contractCode_dialogFormVisible=!1,e.edit_contractCode_form.contractInfoId="",e.edit_contractCode_form.projectCode="",window.location.reload()):t.$notify.error({title:"错误",message:a.data.data.errMsg})})).catch((function(e){console.log(e),t.$notify.error({title:"错误",message:"出错了！"})}))})).catch((function(){t.$message({type:"info",message:"已取消操作！"})}))},ConfirmEnd:function(t){var e=this,a=this;this.$confirm("确认要结束流程吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var o="/transferring/processComplete?contractInfoId="+t.contractInfoId;a.request(o,{},"GET",{}).then((function(t){"success"==t.data.status?(e.$message({message:"流程已结束！",type:"success"}),window.location.reload()):e.$message({message:t.data.data.errMsg,type:"error"})})).catch((function(t){console.log(t),e.$message({message:"出错了！",type:"error"})}))})).catch((function(){e.$message({type:"info",message:"已取消删除"})}))}})},d=l,u=(a("0473"),a("2877")),p=Object(u["a"])(d,o,n,!1,null,null,null);e["default"]=p.exports},af2c:function(t,e,a){"use strict";a("ac1f"),a("1276"),a("caad"),a("d3b7"),a("3ca3"),a("ddb0"),a("2b3d");var o=a("4ec3"),n=a("5c96"),r=a.n(n),c=function(t){var e="/file/downloadFileById?fileId="+t;Object(o["a"])(e,{},"GET",{},"arraybuffer").then((function(t){if(console.log(t),void 0==t.headers["content-disposition"])r.a.Notification({title:"错误",message:"文件可能丢失了！",type:"error"});else{var e="",a=t.headers["content-disposition"].split("fileName=")[1].split(".").length,o=t.headers["content-disposition"].split("fileName=")[1].split(".")[a-1];if(["pdf","png","jpg","jpeg"].includes(o)){switch(o){case"pdf":e="application/pdf";break;case"png":e="image/png";break;case"jpg":e="image/jpeg";break;case"jpeg":e="image/jpeg";break}var n=t.data,c=decodeURI(t.headers["content-disposition"].split("fileName=")[1]);if(window.navigator&&window.navigator.msSaveOrOpenBlob){var s=new Blob([n],{type:e});console.log(c),window.navigator.msSaveOrOpenBlob(s,c)}else{var i=new Blob([n],{type:e}),l=window.URL.createObjectURL(i);console.log(l),window.open(l)}}else r.a.Notification({title:"提示",message:"该文件类型暂不支持在线预览，请下载后查看！",type:"warning"})}})).catch((function(t){console.log(t),r.a.Message({message:"出错了！",type:"error"})}))},s=function(t){Object(o["a"])(t,{},"GET",{},"blob").then((function(e){if(console.log(e),void 0!=e.headers["content-disposition"]){r.a.Notification({title:"成功",message:"准备开始下载！",type:"success"});var a=decodeURI(e.headers["content-disposition"].split("fileName=")[1]);try{var n=new Blob([e.data],{type:"application/force-download"}),c=URL.createObjectURL(n),s=document.createElement("a");s.href=c,s.setAttribute("download",a),document.body.appendChild(s),s.click(),document.body.removeChild(s)}catch(i){console.log(i),r.a.Message({message:"数据请求失败！",type:"error"})}}else Object(o["a"])(t,{},"GET",{}).then((function(t){r.a.Message({message:t.data.data.errMsg,type:"error"})}))})).catch((function(t){console.log(t),r.a.Message({message:"出错了！",type:"error"})}))},i=function(t,e){var a="";if(0==e.length)r.a.Notification.warning({title:"提示",message:"文件为空！"});else{if(1==e.length)a="/file/downloadPackage?projectCode="+t+"&fileIdList="+e[0];else if(e.length>1){a="/file/downloadPackage?projectCode="+t+"&fileIdList="+e[0];for(var n=1;n<e.length;n++)a=a+"&fileIdList="+e[n]}Object(o["a"])(a,{},"GET",{},"blob").then((function(t){if(void 0!=t.headers["content-disposition"]){r.a.Notification({title:"成功",message:"准备开始下载！",type:"success"});var e=decodeURI(t.headers["content-disposition"].split("fileName=")[1]);try{var a=new Blob([t.data],{type:"application/force-download"}),o=URL.createObjectURL(a),n=document.createElement("a");n.href=o,n.setAttribute("download",e),document.body.appendChild(n),n.click(),document.body.removeChild(n)}catch(c){console.log(c),r.a.Message({message:"数据请求失败！",type:"error"})}}else r.a.Message({message:"文件可能丢失了！",type:"error"})})).catch((function(t){console.log(t),r.a.Message({message:"出错了！",type:"error"})}))}};e["a"]={previewFile:c,downloadFiles:s,downloadFilePackage:i}}}]);